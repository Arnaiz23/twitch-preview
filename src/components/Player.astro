---
import ShareIcon from "@/components/Icons/Share.astro";
import DotsVertical from "@/components/Icons/DotsVertical.astro";
import ButtonIcons from "@/components/ButtonIcons.astro";
import ButtonText from "@/components/ButtonText.astro";
import LikeIcon from "@/components/Icons/Like.astro";
import BellIcon from "@/components/Icons/Bell.astro";
import StarIcon from "@/components/Icons/Star.astro";
import ArrowDownIcon from "@/components/Icons/ArrowDown.astro";
import ChannelVideosSlider from "@/components/ChannelVideosSlider.astro";

import streams from "@/data/recentBroadcasts.json";
import highlightsStreams from "@/data/highlights.json";

import type { Channels } from "@/types";

const streamData: Channels = {
  channel: "DessT3",
  image:
    "https://static-cdn.jtvnw.net/jtv_user_pictures/12e13232-fdcd-4e75-88d3-f73682a03e24-profile_image-70x70.png",
  categorie: "Grand Theft Auto V",
  viewers: "16.6",
  description: "EL MAGO BO! | LA LIGA DE LA JUSTICIA | !ig",
};

const date = new Date("05-20-2024");
const relativeTime = new Intl.RelativeTimeFormat("en", {
  style: "short",
}).format(date.getDay() - new Date().getDay(), "day");
---

<section id="player" class="w-full overflow-y-auto">
  <picture class="w-full">
    <source srcset="/preview.webp" type="image/webp" />
    <img src="/preview.png" class="aspect-video" alt="Video preview" />
  </picture>
  <section class="w-full p-5">
    <header class="w-full">
      <div class="w-full flex justify-between items-center p-2">
        <p class="text-zinc-300 font-bold text-sm">{relativeTime}</p>
        <div class="w-max flex gap-1 items-center justify-evenly text-white">
          <button
            class="flex gap-1 items-center justify-evenly bg-[#2e2e35] hover:bg-zinc-700 text-white py-1 px-2 rounded-sm font-semibold text-xs"
          >
            <ShareIcon />
            Share
          </button>
          <ButtonIcons title="Video options" position="bottom" hidden={true}>
            <DotsVertical size="size-5" />
          </ButtonIcons>
        </div>
      </div>
      <div class="text-white flex flex-col items-start gap-2">
        <h2 class="font-bold text-lg">{streamData.description}</h2>
        <div class="flex gap-2 items-center justify-start">
          <ButtonText text={streamData.categorie} show />
          <span class="bg-violet-400 size-1 rounded-full"></span>
          <p class="text-xs text-zinc-400">{streamData.viewers} views</p>
        </div>
      </div>
    </header>
  </section>
  <section
    class="w-[98%] flex items-start justify-between bg-[#1f1f23] text-white p-3 rounded-xl mx-auto"
  >
    <div class="flex items-start justify-start">
      <img
        src="https://static-cdn.jtvnw.net/jtv_user_pictures/12e13232-fdcd-4e75-88d3-f73682a03e24-profile_image-70x70.png"
        alt="DessT3 avatar"
        class="rounded-full"
      />
      <div class="text-[13px]">
        <h2 class="text-xl font-semibold">{streamData.channel}</h2>
        <p>Last live 21 hours ago</p>
        <p>576K followers</p>
      </div>
    </div>
    <div class="flex items-center justify-evenly gap-2">
      <button
        class="bg-[#53535f7a] rounded-md py-1 px-2 relative group hover:bg-red-300"
      >
        <LikeIcon class="size-5 fill-white group-hover:fill-black" />
        <div
          class="absolute bottom-[140%] left-2/4 -translate-x-2/4 w-max opacity-0 group-hover:opacity-100 transition-all duration-500 pointer-events-none"
        >
          <span
            class={`absolute left-2/4 border-t-8 border-t-white border-r-[6px] border-r-transparent border-l-[6px] border-l-transparent -translate-x-2/4 w-0 h-0 top-full`}
          ></span>
          <p class="p-1 bg-white text-black w-max rounded text-xs font-bold">
            Unfollow
          </p>
        </div>
      </button>
      <button class="bg-[#53535f7a] rounded-md py-1 px-2 relative group">
        <BellIcon
          class="size-5 fill-white group-hover:scale-125 transition-transform duration-500"
        />
        <div
          class="absolute bottom-[140%] left-2/4 -translate-x-2/4 w-max opacity-0 group-hover:opacity-100 transition-all duration-500 pointer-events-none"
        >
          <span
            class={`absolute left-2/4 border-t-8 border-t-white border-r-[6px] border-r-transparent border-l-[6px] border-l-transparent -translate-x-2/4 w-0 h-0 top-full`}
          ></span>
          <p class="p-1 bg-white text-black w-max rounded text-xs font-bold">
            Turn notifications off
          </p>
        </div>
      </button>
      <button
        class="flex items-center justify-evenly bg-[#772ce8] text-white rounded-md px-2 py-1 text-[13px] font-semibold gap-1 hover:bg-violet-700"
      >
        <StarIcon class="size-5 fill-white" />
        Suscribe
        <ArrowDownIcon class="size-5 fill-white" />
      </button>
    </div>
  </section>

  <section class="text-white px-4 py-3 flex items-center gap-2 text-[13px]">
    <p class="font-semibold">Filter by</p>
    <select class="p-2 rounded">
      <option value="default">Default</option>
      <option value="pastBroadcast">Past Broadcasts</option>
      <option value="highlights">Highlights</option>
      <option value="clips">Clips</option>
      <option value="uploads">Uploads</option>
      <option value="collections">Collections</option>
      <option value="allVideos">All Videos</option>
    </select>
  </section>
  <ChannelVideosSlider title="Recent broadcasts" streams={streams} />
  <ChannelVideosSlider
    title="Recent highlights and uploads"
    streams={highlightsStreams}
  />
</section>

<style>
  #player {
    grid-area: video;
  }
</style>
